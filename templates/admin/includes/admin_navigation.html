{% load i18n %}

<nav class="space-y-2 text-sm">

    <!-- Users & Permissions -->
    <div>
        <button class="nav-item w-full flex items-center justify-between px-4 py-2 text-gray-300 hover:text-white" data-toggle="collapse" data-target="auth-menu" aria-expanded="false">
            <div class="flex items-center">
                <i class="fas fa-users-cog w-5 h-5 mr-2" aria-hidden="true"></i>
                <span>{% trans "Users & Permissions" %}</span>
            </div>
            <i class="fas fa-angle-down transition-transform" aria-hidden="true"></i>
        </button>
        <ul id="auth-menu" class="pl-4 mt-1 space-y-1 {% if '/manage/accounts/' in request.path %}block{% else %}hidden{% endif %}">
            <li>
                <a href="{% url 'custom_admin:accounts_customuser_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white {% if '/manage/accounts/customuser/' in request.path %}active-nav-item{% endif %}">
                    <i class="fas fa-user w-5 h-5 mr-2" aria-hidden="true"></i>
                    <span>{% trans "Users" %}</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- Company -->
    <div>
        <button class="nav-item w-full flex items-center justify-between px-4 py-2 text-gray-300 hover:text-white" data-toggle="collapse" data-target="company-menu" aria-expanded="false">
            <div class="flex items-center"></div>    
            <i class="fas fa-building w-5 h-5 mr-2" aria-hidden="true"></i>
                <span>{% trans "Company" %}</span>
            </div>
             <i class="fas fa-angle-down transition-transform" aria-hidden="true"></i>
        </button>
        <ul id="company-menu" class="pl-4 mt-1 space-y-1 {% if '/manage/company/' in request.path %}block{% else %}hidden{% endif %}">
            <li>
                <a href="{% url 'custom_admin:company_company_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">
                    {% trans "Companies" %}
                </a>
            </li>
        </ul>
    </div>

    <!-- Personnel -->
    <div>
        <button class="nav-item w-full flex items-center justify-between px-4 py-2 text-gray-300 hover:text-white" data-toggle="collapse" data-target="personnel-menu" aria-expanded="false">
            <div class="flex items-center">
                <i class="fas fa-id-badge w-5 h-5 mr-2" aria-hidden="true"></i>
                <span>{% trans "Personnel" %}</span>
            </div>
            <i class="fas fa-angle-down transition-transform" aria-hidden="true"></i>
        </button>
        <ul id="personnel-menu" class="pl-4 mt-1 space-y-1 {% if '/manage/personnel/' in request.path %}block{% else %}hidden{% endif %}">
            <li><a href="{% url 'custom_admin:personnel_employee_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Employees" %}</a></li>
            <li><a href="{% url 'custom_admin:personnel_qualification_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Qualifications" %}</a></li>
            <li><a href="{% url 'custom_admin:personnel_trainingrecord_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Training Records" %}</a></li>
        </ul>
    </div>

    <!-- Equipment -->
    <div>
        <button class="nav-item w-full flex items-center justify-between px-4 py-2 text-gray-300 hover:text-white" data-toggle="collapse" data-target="equipment-menu" aria-expanded="false">
            <div class="flex items-center">
                <i class="fas fa-tools w-5 h-5 mr-2" aria-hidden="true"></i>
                <span>{% trans "Equipment" %}</span>
            </div>
            <i class="fas fa-angle-down transition-transform" aria-hidden="true"></i>
        </button>
        <ul id="equipment-menu" class="pl-4 mt-1 space-y-1 {% if '/manage/equipment/' in request.path %}block{% else %}hidden{% endif %}">
            <li><a href="{% url 'custom_admin:equipment_equipment_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Registry" %}</a></li>
            <li><a href="{% url 'custom_admin:equipment_equipmentcategory_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Categories" %}</a></li>
            <li><a href="{% url 'custom_admin:equipment_maintenancerecord_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Maintenance" %}</a></li>
        </ul>
    </div>

    <!-- Documents -->
    <div>
        <button class="nav-item w-full flex items-center justify-between px-4 py-2 text-gray-300 hover:text-white" data-toggle="collapse" data-target="docs-menu" aria-expanded="false">
            <div class="flex items-center">
                <i class="fas fa-file-alt w-5 h-5 mr-2" aria-hidden="true"></i>
                <span>{% trans "Documents" %}</span>
            </div>
            <i class="fas fa-angle-down transition-transform" aria-hidden="true"></i>
        </button>
        <ul id="docs-menu" class="pl-4 mt-1 space-y-1 {% if '/manage/quality_docs/' in request.path %}block{% else %}hidden{% endif %}">
            <li><a href="{% url 'custom_admin:quality_docs_qualitydocument_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Quality Docs" %}</a></li>
            <li><a href="{% url 'custom_admin:quality_docs_documenttype_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Doc Types" %}</a></li>
            <li><a href="{% url 'custom_admin:quality_docs_documentsection_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Sections" %}</a></li>
        </ul>
    </div>

    <!-- Standards -->
    <div>
        <button class="nav-item w-full flex items-center justify-between px-4 py-2 text-gray-300 hover:text-white" data-toggle="collapse" data-target="standards-menu" aria-expanded="false">
            <div class="flex items-center">
                <i class="fas fa-clipboard-list w-5 h-5 mr-2" aria-hidden="true"></i>
                <span>{% trans "Standards" %}</span>
            </div>
            <i class="fas fa-angle-down transition-transform" aria-hidden="true"></i>
        </button>
        <ul id="standards-menu" class="pl-4 mt-1 space-y-1 {% if '/manage/standards/' in request.path %}block{% else %}hidden{% endif %}">
            <li><a href="{% url 'custom_admin:standards_standard_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Standards" %}</a></li>
            <li><a href="{% url 'custom_admin:standards_standardsection_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Sections" %}</a></li>
            <li><a href="{% url 'custom_admin:standards_standarddocument_changelist' %}" class="nav-item flex items-center px-4 py-2 hover:text-white">{% trans "Documents" %}</a></li>
        </ul>
    </div>

</nav>

<script>
document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('[data-toggle="collapse"]').forEach(button => {
        button.addEventListener('click', () => {
            const targetId = button.getAttribute('data-target');
            const menu = document.getElementById(targetId);
            if (menu) {
                menu.classList.toggle('hidden');
                menu.classList.toggle('block');
                const icon = button.querySelector('.fa-angle-down');
                if (icon) icon.classList.toggle('rotate-180');
            }
        });
    });
});
</script>

<style>
.active-nav-item {
    background-color: #2563eb;
    color: white !important;
}
.rotate-180 {
    transform: rotate(180deg);
    transition: transform 0.2s ease-in-out;
}
</style>
