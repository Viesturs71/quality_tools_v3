{% extends 'base.html' %}
{% load i18n %}
{% load crispy_forms_tags %}

{% block title %}{% if form.instance.pk %}{% trans "Edit Equipment" %}{% else %}{% trans "Add Equipment" %}{% endif %} | Quality Tools{% endblock %}

{% block content %}
<div class="content-section">
    <div class="section-header">
        {% if form.instance.pk %}
            {% trans "Edit Equipment" %}
        {% else %}
            {% trans "Add Equipment" %}
        {% endif %}
    </div>

    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <!-- General Information Section -->
        <div class="content-section">
            <div class="section-header">{% trans "General Information" %}</div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label class="form-label">{% trans "Equipment Name" %}*</label>
                    <input type="text" class="form-control" name="{{ form.equipment_name.name }}" 
                           value="{{ form.equipment_name.value|default:'' }}" required>
                    {% if form.equipment_name.errors %}
                        <div class="text-red-500 text-sm mt-1">{{ form.equipment_name.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Equipment/Measuring Instrument Type" %}*</label>
                    {{ form.equipment_type }}
                    {% if form.equipment_type.errors %}
                        <div class="text-red-500 text-sm mt-1">{{ form.equipment_type.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Type" %}</label>
                    <input type="text" class="form-control" name="{{ form.type.name }}" 
                           value="{{ form.type.value|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Manufacturer" %}</label>
                    <input type="text" class="form-control" name="{{ form.manufacturer.name }}"
                           value="{{ form.manufacturer.value|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Inventory Number" %}*</label>
                    <input type="text" class="form-control" name="{{ form.inventory_number.name }}"
                           value="{{ form.inventory_number.value|default:'' }}" required>
                    {% if form.inventory_number.errors %}
                        <div class="text-red-500 text-sm mt-1">{{ form.inventory_number.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Serial Number" %}*</label>
                    <input type="text" class="form-control" name="{{ form.serial_number.name }}"
                           value="{{ form.serial_number.value|default:'' }}" required>
                    {% if form.serial_number.errors %}
                        <div class="text-red-500 text-sm mt-1">{{ form.serial_number.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Location" %}*</label>
                    <input type="text" class="form-control" name="{{ form.location.name }}"
                           value="{{ form.location.value|default:'' }}" required>
                    {% if form.location.errors %}
                        <div class="text-red-500 text-sm mt-1">{{ form.location.errors }}</div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Documentation Section -->
        <div class="content-section">
            <div class="section-header">{% trans "Documentation" %}</div>
            
            <div class="form-group">
                <label class="form-label">{% trans "User Manual Document" %}</label>
                <input type="file" name="{{ form.manual_file.name }}" class="form-control">
                {% if form.manual_file.errors %}
                    <div class="text-red-500 text-sm mt-1">{{ form.manual_file.errors }}</div>
                {% endif %}
                {% if form.instance.manual_file %}
                    <p class="text-sm mt-1">{% trans "Current file" %}: <a href="{{ form.instance.manual_file.url }}" target="_blank">{{ form.instance.manual_file.name }}</a></p>
                {% endif %}
            </div>
            
            <div class="form-group">
                <label class="form-label">{% trans "User Manual URL" %}</label>
                <input type="url" class="form-control" name="{{ form.manual_url.name }}"
                       value="{{ form.manual_url.value|default:'' }}" placeholder="{% trans 'Link to online documentation' %}">
            </div>
            
            <div class="form-group">
                <label class="form-label">{% trans "Additional Documentation" %}</label>
                <textarea class="form-control" name="{{ form.documentation.name }}" rows="3">{{ form.documentation.value|default:'' }}</textarea>
            </div>
        </div>
        
        <!-- Department Information -->
        <div class="content-section">
            <div class="section-header">{% trans "Department Information" %}</div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label class="form-label">{% trans "Department" %}</label>
                    {{ form.department }}
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Person Responsible" %}</label>
                    <input type="text" class="form-control" name="{{ form.responsible_person.name }}"
                           value="{{ form.responsible_person.value|default:'' }}">
                </div>
            </div>
        </div>
        
        <!-- Dates and Financial Information -->
        <div class="content-section">
            <div class="section-header">{% trans "Dates and Financial Information" %}</div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="form-group">
                    <label class="form-label">{% trans "Manufacture Date" %}</label>
                    <input type="date" class="form-control" name="{{ form.manufacture_date.name }}"
                           value="{{ form.manufacture_date.value|date:'Y-m-d'|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Purchase Date" %}</label>
                    <input type="date" class="form-control" name="{{ form.purchase_date.name }}"
                           value="{{ form.purchase_date.value|date:'Y-m-d'|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Purchase Price" %}</label>
                    <input type="number" step="0.01" class="form-control" name="{{ form.purchase_price.name }}"
                           value="{{ form.purchase_price.value|default:'' }}">
                </div>
            </div>
        </div>
        
        <!-- Metrological Control -->
        <div class="content-section">
            <div class="section-header">{% trans "Metrological Control" %}</div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label class="form-label">{% trans "Metrological Control Type" %}</label>
                    {{ form.inspection_type }}
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Metrological Control Institution" %}</label>
                    <input type="text" class="form-control" name="{{ form.inspection_institution.name }}"
                           value="{{ form.inspection_institution.value|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Certificate Number/Date" %}</label>
                    <input type="text" class="form-control" name="{{ form.certificate_number_date.name }}"
                           value="{{ form.certificate_number_date.value|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Metrological Control Periodicity (days)" %}</label>
                    <input type="number" class="form-control" name="{{ form.inspection_frequency.name }}"
                           value="{{ form.inspection_frequency.value|default:'' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label">{% trans "Next Verification Date" %}</label>
                    <input type="date" class="form-control" name="{{ form.next_inspection_date.name }}"
                           value="{{ form.next_inspection_date.value|date:'Y-m-d'|default:'' }}">
                </div>
            </div>
        </div>
        
        <!-- Status Information -->
        <div class="content-section">
            <div class="section-header">{% trans "Status Information" %}</div>
            
            <div class="form-group">
                <label class="form-label">{% trans "Technical Status" %}</label>
                {{ form.technical_status }}
            </div>
            
            <div class="form-group">
                <label class="form-label">{% trans "Additional Information" %}</label>
                <textarea class="form-control" name="{{ form.additional_info.name }}" rows="3">{{ form.additional_info.value|default:'' }}</textarea>
            </div>
            
            <div class="form-group">
                <label class="form-label">{% trans "Notes" %}</label>
                <textarea class="form-control" name="{{ form.notes.name }}" rows="3">{{ form.notes.value|default:'' }}</textarea>
            </div>
        </div>
        
        <div class="mt-6 flex justify-end space-x-4">
            <a href="{% url 'equipment:index' %}" class="px-4 py-2 border border-gray-300 rounded">{% trans "Cancel" %}</a>
            <button type="submit" class="btn-primary">{% trans "Save" %}</button>
        </div>
    </form>
</div>
{% endblock %}
